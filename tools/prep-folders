#!/bin/bash
# Create a 0-Watched directory inside each immediate subdirectory of the current directory
# and run flatten-input inside each of those directories.

SCRIPT_DIR="$(cd -- "$(dirname "$0")" && pwd)"

# Find all immediate subdirectories and create the target folder within each.
find . -mindepth 1 -maxdepth 1 -type d -print0 | while IFS= read -r -d '' dir; do
  mkdir -p "$dir/0-Watched"
  (cd "$dir" && "$SCRIPT_DIR/flatten-input")
done
